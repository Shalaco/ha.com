(function(a){a.fn.lightbox=function(k){var u=a.extend({},a.fn.lightbox.defaults,k);if(a("#overlay").is(":visible")){a(window).trigger("resize")}function p(){e();o(this);return false}if(parseFloat(a().jquery)>=1.7){return a(this).on("click",p)}else{return a(this).live("click",p)}function e(){a(window).bind("orientationchange",q);a(window).bind("resize",q);a("#overlay").remove();a("#lightbox").remove();u.isIE8=v();u.inprogress=false;u.auto=-1;var A=u.strings;var z='<div id="outerImageContainer"><div id="imageContainer"><iframe id="lightboxIframe" /><img id="lightboxImage"><div id="hoverNav"><a href="javascript://" title="'+A.prevLinkTitle+'" id="prevLink"></a><a href="javascript://" id="nextLink" title="'+A.nextLinkTitle+'"></a></div><div id="jqlb_loading"><a href="javascript://" id="loadingLink"><div id="jqlb_spinner"></div></a></div></div></div>';var C='<div id="imageDataContainer" class="clearfix"><div id="imageData"><div id="imageDetails"><span id="caption"></span><p id="controls"><span id="numberDisplay"></span> <span id="downloadLink"><a href="" target="'+u.linkTarget+'">'+A.download+'</a></span></p></div><div id="bottomNav">';if(u.displayHelp){C+='<span id="helpDisplay">'+A.help+"</span>"}C+='<a href="javascript://" id="bottomNavClose" title="'+A.closeTitle+'"><div id="jqlb_closelabel"></div></a></div></div></div>';var B;if(u.navbarOnTop){B='<div id="overlay"></div><div id="lightbox">'+C+z+"</div>";a("body").append(B);a("#imageDataContainer").addClass("ontop")}else{B='<div id="overlay"></div><div id="lightbox">'+z+C+"</div>";a("body").append(B)}a("#overlay").click(function(){h()}).hide();a("#lightbox").click(function(){h()}).hide();a("#loadingLink").click(function(){h();return false});a("#bottomNavClose").click(function(){h();return false});a("#outerImageContainer").width(u.widthCurrent).height(u.heightCurrent);a("#imageDataContainer").width(u.widthCurrent);if(!u.imageClickClose){a("#lightboxImage").click(function(){return false});a("#hoverNav").click(function(){return false})}}function q(z){if(u.resizeTimeout){clearTimeout(u.resizeTimeout);u.resizeTimeout=false}u.resizeTimeout=setTimeout(function(){y()},50)}function x(){var A=a(document).height();if(u.isIE8&&A>4096){A=4096}var z=a(window).height()-u.adminBarHeight;return new Array(a(document).width(),A,a(window).width(),z,a(document).height())}function v(){var A=false;if(document.createElement){var z=document.createElement("div");if(z&&z.querySelectorAll){z.innerHTML='<object><param name=""></object>';A=z.querySelectorAll("param").length!=1}z=null}return A}function g(){var A=0;var z=0;if(self.pageYOffset){z=self.pageYOffset;A=self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){z=document.documentElement.scrollTop;A=document.documentElement.scrollLeft}else{if(document.body){z=document.body.scrollTop;A=document.body.scrollLeft}}}if(u.adminBarHeight&&parseInt(a("#wpadminbar").css("top"),10)===0){z+=u.adminBarHeight}return new Array(A,z)}function o(E){var D=x();var A=g();var B=0;a("#overlay").hide().css({width:D[0]+"px",height:D[1]+"px",opacity:u.overlayOpacity}).fadeIn(400);if(u.isIE8&&D[1]==4096){if(A[1]>=1000){B=A[1]-1000;if((D[4]-(A[1]+3096))<0){B-=(A[1]+3096)-D[4]}a("#overlay").css({top:B+"px"})}}var C=0;var z=[];u.downloads={};a("a").each(function(){if(!this.href||(this.rel!=E.rel)){return}var J="";var G="";var L="";var F=a(this);var I=F.children("img:first-child");if(this.title){J=this.title}else{if(I.attr("title")){J=I.attr("title")}else{if(I.attr("alt")){J=I.attr("alt")}}}if(F.parent().next(".gallery-caption").html()){var K=F.parent().next(".gallery-caption");G=K.html();L=K.text()}else{if(F.next(".wp-caption-text").html()){G=F.next(".wp-caption-text").html();L=F.next(".wp-caption-text").text()}}J=a.trim(J);L=a.trim(L);if(J.toLowerCase()==L.toLowerCase()){J=G;G=""}var H="";if(J!=""){H='<span id="titleText">'+J+"</span>"}if(G!=""){if(J!=""){H+="<br />"}H+='<span id="captionText">'+G+"</span>"}if(u.displayDownloadLink||F.attr("data-download")){u.downloads[z.length]=F.attr("data-download")}z.push(new Array(this.href,u.displayTitle?H:"",z.length))});if(z.length>1){for(i=0;i<z.length;i++){for(j=z.length-1;j>i;j--){if(z[i][0]==z[j][0]){z.splice(j,1)}}}while(z[C][0]!=E.href){C++}}u.imageArray=z;m(A[1],A[0]).show();w(C)}function m(z,A){if(u.resizeSpeed>0){return a("#lightbox").animate({top:z+"px",left:A+"px"},250,"linear")}return a("#lightbox").css({top:z+"px",left:A+"px"})}function w(z){if(u.inprogress==false){u.inprogress=true;u.activeImage=z;a("#jqlb_loading").show();a("#lightboxImage").hide();a("#hoverNav").hide();a("#prevLink").hide();a("#nextLink").hide();l()}}function l(){u.imgPreloader=new Image();u.imgPreloader.onload=function(){a("#lightboxImage").attr("src",u.imageArray[u.activeImage][0]);y();f()};u.imgPreloader.src=u.imageArray[u.activeImage][0]}function y(){if(!u.imgPreloader){return}var C=u.imgPreloader.width;var z=u.imgPreloader.height;var E=x();var K=(E[2]<E[0])?E[0]:E[2];a("#overlay").css({width:K+"px",height:E[1]+"px"});var I=(E[3])-(a("#imageDataContainer").height()+(2*u.borderSize));var J=(E[2])-(2*u.borderSize);if(u.fitToScreen){var A=I-u.marginSize;var L=J-u.marginSize;var F=1;if(z>A){F=A/z}C=C*F;z=z*F;F=1;if(C>L){F=L/C}C=Math.round(C*F);z=Math.round(z*F)}var D=g();var B=D[1]+(I*0.5);var G=B-z*0.5;var H=D[0];a("#lightboxImage").width(C).height(z);n(C,z,G,H)}function n(C,A,E,D){u.widthCurrent=a("#outerImageContainer").outerWidth();u.heightCurrent=a("#outerImageContainer").outerHeight();var z=Math.max(350,C+(u.borderSize*2));var B=(A+(u.borderSize*2));u.xScale=(z/u.widthCurrent)*100;u.yScale=(B/u.heightCurrent)*100;m(E,D);c();a("#imageDataContainer").animate({width:z},u.resizeSpeed,"linear");a("#outerImageContainer").animate({width:z,height:B},u.resizeSpeed,"linear",function(){d()});s();a("#prevLink,#nextLink").height(A)}function d(){a("#imageData").show();a("#caption").show();a("#jqlb_loading").hide();if(u.resizeSpeed>0){a("#lightboxImage").fadeIn("fast")}else{a("#lightboxImage").show()}u.inprogress=false}function f(){if(u.imageArray.length>1){preloadNextImage=new Image();preloadNextImage.src=u.imageArray[(u.activeImage==(u.imageArray.length-1))?0:u.activeImage+1][0];preloadPrevImage=new Image();preloadPrevImage.src=u.imageArray[(u.activeImage==0)?(u.imageArray.length-1):u.activeImage-1][0]}else{if((u.imageArray.length-1)>u.activeImage){preloadNextImage=new Image();preloadNextImage.src=u.imageArray[u.activeImage+1][0]}if(u.activeImage>0){preloadPrevImage=new Image();preloadPrevImage.src=u.imageArray[u.activeImage-1][0]}}}function c(){a("#numberDisplay").html("");a("#caption").html("").hide();var A=u.imageArray;var z=u.strings;var E=u.activeImage;var D=A[E][2];if(A[E][1]){a("#caption").html(A[E][1]).show()}var F=(A.length>1)?z.image+(E+1)+z.of+A.length:"";if(u.slidehowSpeed&&A.length>1){var B=(u.auto===-1)?z.play:z.pause;F+=' <a id="playpause" href="#">'+B+"</a>"}if(u.displayDownloadLink||u.downloads[D]){var C=u.downloads[D]?u.downloads[D]:A[E][0];a("#downloadLink").show().children().attr("href",C)}else{a("#downloadLink").hide()}if(F!=""){a("#numberDisplay").html(F).show()}if(u.slidehowSpeed){a("#numberDisplay").unbind("click").click(function(){if(u.auto!=-1){a(this).children("a").text(z.play);clearInterval(u.auto);u.auto=-1}else{a(this).children("a").text(z.pause);u.auto=setInterval(function(){w((u.activeImage==(u.imageArray.length-1))?0:u.activeImage+1)},u.slidehowSpeed)}return false})}}function s(){if(u.imageArray.length>1){a("#hoverNav").show();a("#prevLink").show().click(function(){w((u.activeImage==0)?(u.imageArray.length-1):u.activeImage-1);return false});a("#nextLink").show().click(function(){w((u.activeImage==(u.imageArray.length-1))?0:u.activeImage+1);return false});if(a.fn.touchwipe){a("#imageContainer").touchwipe({wipeLeft:function(){w((u.activeImage==0)?(u.imageArray.length-1):u.activeImage-1)},wipeRight:function(){w((u.activeImage==(u.imageArray.length-1))?0:u.activeImage+1)},min_move_x:20,preventDefaultEvents:true})}b()}}function h(){r();clearInterval(u.auto);u.auto=-1;a("#lightbox").hide();a("#overlay").fadeOut()}function t(C){var D=C.data.opts;var z=C.keyCode;var A=27;var B=String.fromCharCode(z).toLowerCase();if((B=="x")||(B=="o")||(B=="c")||(z==A)){h()}else{if((B=="p")||(z==37)){r();w((D.activeImage==0)?(D.imageArray.length-1):D.activeImage-1)}else{if((B=="n")||(z==39)){r();w((D.activeImage==(D.imageArray.length-1))?0:D.activeImage+1)}}}return false}function b(){a(document).bind("keydown",{opts:u},t)}function r(){a(document).unbind("keydown")}};a.fn.lightbox.defaults={adminBarHeight:28,overlayOpacity:0.8,borderSize:10,imageArray:new Array,activeImage:null,inprogress:false,widthCurrent:250,heightCurrent:250,xScale:1,yScale:1,displayTitle:true,imageClickClose:true,followScroll:false,isIE8:false};a(document).ready(doLightBox)})(jQuery);function doLightBox(){var a=(typeof JQLBSettings=="object");var d,b,c=0;if(a&&JQLBSettings.slideshowSpeed){d=parseInt(JQLBSettings.slideshowSpeed)}if(a&&JQLBSettings.resizeSpeed){b=parseInt(JQLBSettings.resizeSpeed)}if(a&&JQLBSettings.marginSize){c=parseInt(JQLBSettings.marginSize)}var e={help:" Browse images with your keyboard: Arrows or P(revious)/N(ext) and X/C/ESC for close.",prevLinkTitle:"previous image",nextLinkTitle:"next image",closeTitle:"close image gallery",image:"Image ",of:" of ",download:"Download",pause:"(pause slideshow)",play:"(play slideshow)"};jQuery('a[rel^="lightbox"]').lightbox({adminBarHeight:jQuery("#wpadminbar").height()||0,linkTarget:(a&&JQLBSettings.linkTarget.length)?JQLBSettings.linkTarget:"_self",displayHelp:(a&&JQLBSettings.help.length)?true:false,marginSize:(a&&c)?c:0,fitToScreen:(a&&JQLBSettings.fitToScreen=="1")?true:false,resizeSpeed:(a&&b>=0)?b:400,slidehowSpeed:(a&&d>=0)?d:4000,displayDownloadLink:(a&&JQLBSettings.displayDownloadLink=="0")?false:true,navbarOnTop:(a&&JQLBSettings.navbarOnTop=="0")?false:true,strings:(a&&typeof JQLBSettings.help=="string")?JQLBSettings:e})};